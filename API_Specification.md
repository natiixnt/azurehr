## **Frontend API Requirements**

This document outlines the API specification the frontend will be building against. We require two main endpoints to handle the candidate analysis workflow.

### **1. Start Analysis (Input)**

The frontend will send the job description and all CV files in a single request to initiate the analysis.

**Endpoint:** `POST /api/analyze`

**Request Format:** `multipart/form-data`

**Form Fields:**

`jobDescription`: (string) The full text of the job offer.

`cvFiles`: (array of files) One or more CV files (e.g., .pdf, .docx).

**Expected Response (Success):** `202 Accepted`

The backend should start the asynchronous analysis (Form Recognizer + GPT-4o).
The response body should return an ID for polling the results.

```
{
  "analysisId": "xyz-analysis-123",
  "status": "Processing"
}
```

### **2. Get Analysis Results (Output)**

The frontend will poll this endpoint using the analysisId to get the final report.

**Endpoint:** `GET /api/results/{analysisId}`

**Expected Response (Success):** `200 OK`

**Response Body:** The frontend requires the exact JSON structure defined below to render the results dashboard and the detailed candidate reports.


### **Required JSON Response Structure:**

The candidates array should be sorted by overallScore (descending).
```
{
  // analysis
  "analysisId": "xyz-analysis-123",
  "analysisTimestamp": "2025-11-05T18:15:00Z",
  "jobDetails": {
    "title": "Senior Java Developer",
    "summary": "Analiza wymagań dla stanowiska..." // or to be generated by chatgpt
  },
  
  // candidate list (for view2: outcomes) 
  // sorted by best match
  "candidates": [
    {
      // section 1: data (view2)
      "candidateId": "cand-001",
      "fileName": "Jan_Kowalski_CV.pdf",
      "extractedName": "Jan Kowalski",
      "overallScore": 92, // score in %
      "aiBriefSummary": "Idealne dopasowanie techniczne (Java, Spring, AWS). Brakuje formalnego doświadczenia w zarządzaniu zespołem, ale prowadził projekty.",
      "status": "Completed", // or "Error", "Processing"
      
      // section 2: full raport (for view3)
      // frontend downloads this, when the user clicks "View Raport"
      // (we can lazy load or send all at once)
      "detailedReport": {
        "aiFullSummary": "Jan Kowalski jest dobrym kandydatem... (dłuższy akapit). Jego mocne strony to X, Y, Z. Słabsze punkty to A, B.",
        
        // MAIN SECTION (MOST IMPORTANT): side-by-side analysis 
        "matchAnalysis": [
          {
            "requirement": "Min. 5 lat doświadczenia w Java",
            "matchStatus": "HIGH", // HIGH, MEDIUM, LOW, NONE
            "aiJustification": "Kandydat posiada 7 lat komercyjnego doświadczenia w Java (zgodnie z historią zatrudnienia).",
            "evidence": [
              "XYZ Corp (2018-2025): Java Developer",
              "ABC Soft (2016-2018): Junior Java Developer"
            ]
          },
          {
            "requirement": "Biegła znajomość Spring Boot",
            "matchStatus": "HIGH",
            "aiJustification": "Wielokrotnie wymienia Spring Boot w opisie projektów w firmie XYZ Corp.",
            "evidence": [
              "Projekt 'Platforma Bankowa': '...użycie Spring Boot, Spring Security...'"
            ]
          },
          {
            "requirement": "Doświadczenie w zarządzaniu zespołem",
            "matchStatus": "MEDIUM",
            "aiJustification": "Brak formalnego stanowiska 'Team Lead', ale opisuje rolę 'mentora' i 'lidera technicznego' w projekcie 'Platforma Bankowa'.",
            "evidence": [
              "'...odpowiedzialny za mentoring 2 młodszych programistów...'"
            ]
          },
          {
            "requirement": "Znajomość platformy Azure",
            "matchStatus": "NONE",
            "aiJustification": "Kandydat nie wymienia Azure. Posiada doświadczenie w AWS (EC2, S3).",
            "evidence": []
          }
        ],
        // section3: raw data from Form Recognizer (optional)
        "rawExtractedData": {
          "contactInfo": {
            "email": "jan.kowalski@email.com",
            "phone": "123-456-789"
          },
          "education": [
            { "degree": "Magister Inżynier", "school": "Politechnika Warszawska" }
          ],
          "workExperience": [
            { "company": "XYZ Corp", "role": "Java Developer", "duration": "2018-2025" },
            { "company": "ABC Soft", "role": "Junior Java Developer", "duration": "2016-2018" }
          ],
          "skills": ["Java", "Spring", "AWS", "SQL", "Docker"]
        }
      }
    },
    {
      // next candidate
      "candidateId": "cand-002",
      "fileName": "Anna_Nowak_CV.pdf",
      "extractedName": "Anna Nowak",
      "overallScore": 65,
      "aiBriefSummary": "Silne umiejętności w Python i Data Science, ale ograniczone doświadczenie w Java i brak znajomości Spring.",
      "status": "Completed",
      "detailedReport": {
        // ... (structure same as for jan)
      }
    },
    {
      // candidate for whom analysis did not proceed as intended
      "candidateId": "cand-003",
      "fileName": "CV_uszkodzone.docx",
      "extractedName": null,
      "overallScore": 0,
      "aiBriefSummary": "Błąd: Nie można przeanalizować pliku. Plik może być uszkodzony lub w nieobsługiwanym formacie.",
      "status": "Error",
      "detailedReport": null
    }
  ]
}
```

